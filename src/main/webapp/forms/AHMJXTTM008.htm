<div id="AHMJXTTM008" class="div-app" data-version="1.0">
	<div class="global_message">

	</div>

	<div class="row">
		<div class="col-md-12">
			<ul class="nav nav-tabs">
				<li class="active"><a href="#menu1" class="inner-tab">Provinsi</a></li>
				<li class=""><a href="#menu2" class="inner-tab">Kabupaten / Kota</a></li>
			</ul>
		</div>
	</div>

	<div class="row">
		<div class="col-md-12">
			<div class="tab-content">
				
				<!-- PROVINSI -->
				<div id="menu1" class="tab-pane fade in active ">
					<div class="col-md-12">
						<div id="ahmjxttm008m01p01" class="subpage subpage-default" data-path="">
							<div class="row hidden" >
								
								<div class="col-md-6" >
									<table id="ahmjxttm008TableDisable" 
									data-source-id="ahmjxttm008Table" 
									data-unique-id="idCategory"
									data-pagination="true"
									data-page-size="5">
									<thead>
									</thead>
								</table>
							</div>
						</div>
						<div class="form-group-button pull-right">
							<button class="btn btn-default btn-primary large-button" onclick="ahmjxttm008Add(this);return false;">Simpan</button>
						</div>
						
						<div id="table-container">
							<table id="ahmjxttm008m01Table"
							data-method="get"
							data-url="/api/ttm001/dc"
							data-content-type="application/json"
							data-data-type="json"
							data-pagination="true"
							data-page-size="10"
							data-page-list="[10,25,50]"
							data-custom-action="edit, delete"
							data-checkbox-table="ahmjxttm008TableDisable"
							data-unique-id="idCategory">
							<thead>
								<tr>
									<th data-field="state" data-checkbox="true" data-formatter="stateFormatter"></th>
									<th data-field="idCategory" data-sortable="true" data-visible="false">ID</th>
									<th data-field="description" data-sortable="true" data-visible="true">Provinsi</th>
									<th data-field="salesQty" data-sortable="true" data-visible="true">Index Potensi</th>
								</tr>
							</thead>
							
						</table>
					</div>
				</div>
				<!-- End of p01 -->
			</div> 
		</div><!-- End of Menu 1 -->
		
		<!-- KABUPATEN / KOTA -->
		<div id="menu2" class="tab-pane fade in ">
			<div class="col-md-12">
				<div id="ahmjxttm008m02p01" class="subpage subpage-default" data-path="">
					<div class="row hidden" >
						
						<div class="col-md-6" >
							<table id="ahmjxttm008m02TableDisable" 
							data-source-id="ahmjxttm008m02Table" 
							data-unique-id="idCategory"
							data-pagination="true"
							data-page-size="5">
							<thead>
							</thead>
						</table>
					</div>
				</div>
				<div class="form-group-button pull-left">
					<select id="ahmjxttm007p01Provinsi" class="form-control">
						<option></option>
						<option>DKI Jakarta</option>
						<option>Jawa Barat</option>
						<option>Jawa Tengah</option>
					</select>
				</div>
				<div class="form-group-button pull-right">
					<button class="btn btn-default btn-primary large-button" onclick="ahmjxttm008Add(this);return false;">Simpan</button>
				</div>
				
				<div id="table-container">
					<table id="ahmjxttm008m02Table"
					data-method="get"
					data-url="/api/ttm001/dc"
					data-content-type="application/json"
					data-data-type="json"
					data-pagination="true"
					data-page-size="10"
					data-page-list="[10,25,50]"
					data-custom-action="edit, delete"
					data-checkbox-table="ahmjxttm008TableDisable"
					data-unique-id="idCategory">
					<thead>
						<tr>
							<th data-field="state" data-checkbox="true" data-formatter="stateFormatter"></th>
							<th data-field="idCategory" data-sortable="true" data-visible="false">ID</th>
							<th data-field="description" data-sortable="true" data-visible="true">Kota / Kabupaten</th>
							<th data-field="salesQty" data-sortable="true" data-visible="true">Index Potensi</th>
						</tr>
					</thead>
					
				</table>
			</div>
		</div>
		<!-- End of p01 -->
		<!-- End of p02 -->
		
	</div> 
</div><!-- End of Menu 2 -->
</div> <!-- end of tab-content -->
</div>
</div>

<script type="text/javascript">

	function _subpage(obj, id, row){
		_fw_setMessage(obj);
		var parent = $(obj).closest('.menu*');
		console.log(parent);
		if(parent.html() == undefined) {
			parent = $(obj).closest('.tab-pane');
		}
		$('.subpage.subpage-default', parent).removeClass('subpage-default');
		var targetSubpage = $('#'+id);
		_fw_validation_clear(targetSubpage);
		$(targetSubpage).addClass('subpage-default');
		
		automaticFill(row, targetSubpage);
		
	}

	var xdata;
	//var SOURCE= CLIPBOARD = null;
	var SOURCE = [
	{title: "DKI Jakarta",id:"1",children: [
	{title: "Jakarta Pusat",id:"2",children:[
	{title: "Senen",id:"3",lat:"-42.088534",lon:"146.596076"},
	{title: "Kramat",id:"8",lat:"-42.984253",lon:"146.96765"},
	{title: "Gunung Sahari",id:"9",lat:"-42.660900",lon:"146.1096633"},
	{title: "Menteng",id:"10",lat:"-41.088534",lon:"146.596076"},			                             		                                 		      
	]},
	{title: "Jakarta Timur",id:"11"},
	{title: "Jakarta Utara",id:"12"},
	{title: "Jakarta Selatan",id:"13"},
	{title: "Jakarta Barat",id:"14"},		                               		        		     
	]},
	{title: "Jawa Barat",id:"4"},
	{title: "Jawa Timur",id:"5"},
	{title: "Banten",id:"6"},
	{title: "DI Yogyakarta",id:"7"}
	
	],
	CLIPBOARD = null;

	
	$(function(){
		$(".nav-tabs a").click(function(){
			$(this).tab('show');
		});

	/* $.ajax({type: "GET",url: baseURL+"/api/ttm001/sf",contentType: "application/json",
			dataType: 'json',async: false,data: JSON.stringify()})
		.done(function(data){
			var parsed = JSON.parse(JSON.stringify(data), function(k, v) {
				if (k === "description") 
					this.title = v;
				else if (k === "categories")
					this.children = v;
				else
					return v;}
			);
			x = parsed;
			console.log("source==>",SOURCE);
		}) ;  */

	$("#tree6").fancytree({
		source: SOURCE,
		activate: function(event, data) {
			var node = data.node;
			
		},
	});
});

	function ahmjxttm008Add(obj){
		var page = $('#ahmjxttm008p02');
		$('input, select', page).prop('disabled',false);
		_fw_reset_subpage(page);
		_subpage(obj, 'ahmjxttm008p02');
		$('button[name="btnAddNew"]', page).hide();
		$('button[name="btnSubmit"]', page).show();
	}

	function ahmjxttm008AddData(obj){
		var page = $(obj).closest('.subpage');
		_fw_validation_clear(obj);
		_fw_validation_add(obj, 'ahmjxttm008p02Description', 'required');
		_fw_validation_add(obj, 'ahmjxttm008p02SalesQty', 'required');

		if(_fw_validation_validate(obj)){
			var vo = new Object();
			//vo.idCategoryType = $('input[name="idCategoryType"]', page).val();
			//vo.idParentCategory = $('input[name="idParentCategory"]', page).val();
			vo.idCategoryType = 101;
			vo.idParentCategory = 0;
			vo.description = $('input[id="ahmjxttm008p02Description"]', page).val();
			vo.salesQty = $('input[id="ahmjxttm008p02SalesQty"]', page).val();
			
			console.log(vo);

			$.ajax
			({
				type: "POST",
				url: "/ahmjxdsh000/api/partycategory",
				contentType: "application/json",
				dataType: 'json',
				data: JSON.stringify(vo),
				success:function(data){
					console.log(data);
					_fw_setMessage(obj,1,"Success");
					$('#ahmjxttm008Table').bootstrapTable('refresh');
				},
			});
		}
	}

	/* function menu1Edit(obj, row, index){
		_subpage(obj, 'menu1p03', row);
	} */
	
	function ahmjxttm008Edit(obj){
		
		var editedRows = $('#ahmjxttm008TableDisable').bootstrapTable('getData');
		console.log("edited==>",editedRows);
		if (editedRows.length == 1)
		{
			_subpage(obj,'ahmjxttm008p03', editedRows[0]);
			
		}
		else
			alert("Pilih salah satu item jika ingin mengubah.");
	}

	function ahmjxttm008EditData(obj)
	{
		var page = $(obj).closest('.subpage');
		_fw_validation_clear(obj);
		_fw_validation_add(obj, 'ahmjxttm008p03Description', 'required');
		_fw_validation_add(obj, 'ahmjxttm008p03SalesQty', 'required');
		if(_fw_validation_validate(obj)){
			var vo = new Object();
				//vo.idCategoryType = $('input[name="idCategoryType"]', page).val();
				//vo.idParentCategory = $('input[name="idParentCategory"]', page).val();
				vo.idCategory = $('input[name="idCategory"]', page).val();
				vo.idCategoryType = 101;
				vo.idParentCategory = 0;
				vo.description = $('input[id="ahmjxttm008p03Description"]', page).val();
				vo.salesQty = $('input[id="ahmjxttm008p03SalesQty"]', page).val();

				$.ajax
				({
					type: "PUT",
					url: "/ahmjxdsh000/api/partycategory/" + vo.idCategory,
					contentType: "application/json",
					dataType: 'json',
					data: JSON.stringify(vo),
					success:function(data){
						_fw_setMessage(obj,1,"Success");
						$('#ahmjxttm008Table').bootstrapTable('refresh');
					},
				});
			} 
		}

		

		
		

	</script>
